SubDir HAIKU_TOP src system boot platform efi ;

SubDirHdrs $(HAIKU_TOP) src add-ons kernel partitioning_systems gpt ;
UsePrivateHeaders [ FDirName kernel boot ] ;
UsePrivateHeaders [ FDirName kernel boot platform efi ] ;
UsePrivateHeaders [ FDirName kernel boot platform efi protocol ] ;
UsePrivateHeaders [ FDirName kernel boot platform efi arch $(TARGET_ARCH) ] ;

{
	local defines = _BOOT_MODE GNU_EFI_USE_MS_ABI _BOOT_PLATFORM_efi ;
	defines = [ FDefines $(defines) ] ;
	SubDirCcFlags $(defines) ;
	SubDirC++Flags $(defines) -fno-rtti ;
	ObjectC++Flags smp.cpp : -std=c++11 ;
}

local efi_glue_src =
	relocation_func.cpp
	start_func.S
	;

BootMergeObject boot_platform_efi.o :
	console.cpp
	debug.cpp
	devices.cpp
	start.cpp
	video.cpp
#	interrupts.cpp
#	interrupts_asm.S
	entry.S
	keyboard.cpp
	heap.cpp
	mmu.cpp
	acpi.cpp
	serial.cpp
	menu.cpp
	hpet.cpp
	cpu.cpp
	smp.cpp
	smp_trampoline.S
	support.S
	$(efi_glue_src)
	:
	: boot_platform_generic.a
	;

SEARCH on [ FGristFiles $(efi_glue_src)  ] = [ FDirName $(HAIKU_TOP) src system boot platform efi arch $(TARGET_ARCH) ] ;
